(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/info/info"],{2954:function(e,t,o){"use strict";o.r(t);var n=o("fb94"),i=o.n(n);for(var s in n)"default"!==s&&function(e){o.d(t,e,function(){return n[e]})}(s);t["default"]=i.a},"4b69":function(e,t,o){"use strict";var n=o("72df"),i=o.n(n);i.a},"72df":function(e,t,o){},"91f2":function(e,t,o){"use strict";var n=function(){var e=this,t=e.$createElement;e._self._c},i=[];o.d(t,"a",function(){return n}),o.d(t,"b",function(){return i})},e551:function(e,t,o){"use strict";o.r(t);var n=o("91f2"),i=o("2954");for(var s in i)"default"!==s&&function(e){o.d(t,e,function(){return i[e]})}(s);o("4b69");var a=o("2877"),u=Object(a["a"])(i["default"],n["a"],n["b"],!1,null,null,null);t["default"]=u.exports},fb94:function(e,t,o){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(o("98fb"));function i(e){return e&&e.__esModule?e:{default:e}}var s=function(){return o.e("components/uni-popup/uni-popup").then(o.bind(null,"d187"))},a=function(){return o.e("components/m-input").then(o.bind(null,"ee0a"))},u={components:{uniPopup:s,mInput:a},data:function(){return{userName:"",token:"",user_id:0,name:"Tony",department:1,role:"user",hours:12,imgSrc:"",imgSrcOld:"",isChanged:!1,isShowPopup:!1,oldpwd:"",newpwd_1:"",newpwd_2:""}},onLoad:function(){var t=this;this.token=e.getStorageSync("token"),this.user_id=e.getStorageSync("user_id"),this.userName=e.getStorageSync("userName"),this.name=e.getStorageSync("name"),this.department=e.getStorageSync("department"),this.role=e.getStorageSync("role"),this.hours=e.getStorageSync("hours"),e.request({url:n.default+"/face/user/"+this.user_id,header:{Authorization:"Bearer "+this.token},method:"GET",success:function(e){200==e.statusCode?(console.log("获取用户图片成功"," at pages\\info\\info.vue:109"),"available"==e.data.data.status?(t.imgSrc=e.data.data.info,t.imgSrcOld=t.imgSrc):console.log("用户图片暂时不可用"," at pages\\info\\info.vue:115")):console.log("获取用户图片失败"," at pages\\info\\info.vue:118")}})},methods:{chooseImg:function(t){var o=this;e.chooseImage({count:1,sizeType:"compressed",success:function(t){o.isChanged=!0,e.saveFile({tempFilePath:t.tempFilePaths[0],success:function(e){o.imgSrc=e.savedFilePath}})}})},submit:function(t){var o=this;this.isChanged?e.getFileSystemManager().readFile({filePath:this.imgSrc,encoding:"base64",success:function(t){o.imgSrc="data:image/png;base64,"+t.data,e.request({url:n.default+"/face/user/"+o.user_id,header:{Authorization:"Bearer "+o.token},data:{info:o.imgSrc},method:"POST",success:function(t){console.log(t," at pages\\info\\info.vue:187"),201==t.statusCode?(console.log("上传成功"," at pages\\info\\info.vue:189"),o.imgSrcOld=o.imgSrc,e.showToast({duration:2e3,title:"上传成功"})):(console.log("上传失败"," at pages\\info\\info.vue:196"),o.imgSrc=o.imgSrcOld,e.showToast({duration:2e3,title:"上传失败"}))}})}}):(console.log("还未上传图片"," at pages\\info\\info.vue:210"),e.showToast({duration:2e3,title:"您还未选择照片"}))},showPanel:function(e){console.log(e," at pages\\info\\info.vue:218"),this.oldpwd="",this.newpwd_1="",this.newpwd_2="",this.isShowPopup=!0},closePanel:function(){this.isShowPopup=!1},clear:function(){this.oldpwd="",this.newpwd_1="",this.newpwd_2=""},changePwd:function(){this.oldpwd.length<4||this.newpwd_1.length<4||this.newpwd_2.length<4?e.showToast({duration:2e3,title:"密码最短为 4 个字符"}):this.newpwd_1==this.newpwd_2?e.request({url:n.default+"/user/"+this.user_id+"/password",header:{Authorization:"Bearer "+this.token},data:{old_password:this.oldpwd,new_password:this.newpwd_1},method:"PUT",success:function(t){if(200==t.statusCode){e.showToast({duration:2e3,title:"修改密码成功"}),console.log("修改密码请求提交成功"," at pages\\info\\info.vue:259");try{e.clearStorageSync()}catch(o){console.log(o," at pages\\info\\info.vue:264")}e.redirectTo({url:"../login/login"})}else e.showToast({duration:2e3,title:"修改密码失败"}),console.log("修改密码请求提交失败"," at pages\\info\\info.vue:274")},fail:function(){e.showToast({duration:2e3,title:"修改密码失败"}),console.log("修改密码请求提交失败"," at pages\\info\\info.vue:282")}}):e.showToast({duration:2e3,title:"两次输入的新密码不一致"})}}};t.default=u}).call(this,o("6e42")["default"])}},[["13cb","common/runtime","common/vendor"]]]);