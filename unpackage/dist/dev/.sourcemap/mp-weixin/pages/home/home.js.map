{"version":3,"sources":["webpack:///D:/HBuilderX/attsys-miniprogram/pages/home/home.vue","webpack:///D:/HBuilderX/attsys-miniprogram/pages/home/home.vue?c8f1","webpack:///D:/HBuilderX/attsys-miniprogram/pages/home/home.vue?58b6","webpack:///D:/HBuilderX/attsys-miniprogram/pages/home/home.vue?480e","webpack:///D:/HBuilderX/attsys-miniprogram/pages/home/home.vue?7db7","webpack:///D:/HBuilderX/attsys-miniprogram/pages/home/home.vue?6196","webpack:///D:/HBuilderX/attsys-miniprogram/pages/home/home.vue?3760"],"names":["hasUnreadMessage","that","uni","request","url","webSiteUrl","user_id","header","token","method","success","res","console","log","statusCode","showModal","title","content","showCancel","confirm","setStorageSync","e","components","uniPopup","data","userName","check_message","start_at","end_at","isNotCheck","check_token","isShowPopup","canICU","canCheckOff","messageSrc","messageIntervalID","onLoad","getStorageSync","IsNotcheck","sign_id","Date","shift","toLocaleString","timeZone","hour12","name","department","role","hours","setInterval","onUnload","clearInterval","onShow","methods","goShiftArrangement","navigateTo","goLeave","goICU","goInfo","checkIn","scanCode","onlyFromCamera","result","showToast","duration","fail","complete","redirectTo","goMessage","checkOff","overtime"],"mappings":"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","file":"pages/home/home.js","sourcesContent":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\n\timport webSiteUrl from '../../common/webSiteUrl.js';\n\t// 设置计时器查询是否有unread的消息,第二个参数单位是ms\n\tfunction hasUnreadMessage(that){\n\t\t// 向服务器查询unread消息\n\t\tuni.request({\n\t\t\turl: webSiteUrl + 'message?to_user_id=' + that.user_id + '&status=unread&page=' + 1,\n\t\t\theader:{\n\t\t\t\t'Authorization': 'Bearer '+ that.token,\n\t\t\t},\n\t\t\tmethod: 'GET',\n\t\t\tsuccess: (res) => {\n\t\t\t\tconsole.log('计时器：',res);\n\t\t\t\tif (res.statusCode==200) {\n\t\t\t\t\t// unread消息不为空，则提醒用户有新消息，用户点击确认后，关闭计时器\n\t\t\t\t\tuni.showModal({\n\t\t\t\t\t\ttitle: '提示',\n\t\t\t\t\t\tcontent: '您有新消息了，请前往查看',\n\t\t\t\t\t\tshowCancel:false,\n\t\t\t\t\t\tsuccess: function (res) {\n\t\t\t\t\t\t\tif (res.confirm) {\n\t\t\t\t\t\t\t\tconsole.log('用户点击确定');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\t// 将localstorage中的start_query_unread_message设置未false，即停止查询\n\t\t\t\t\ttry{\n\t\t\t\t\t\tuni.setStorageSync('start_query_unread_message',false);\n\t\t\t\t\t}catch(e){\n\t\t\t\t\t\tconsole.log(\"存储出现问题\");\n\t\t\t\t\t}\n\t\t\t\t} else if (res.statusCode==204) {\n\t\t\t\t\tconsole.log(\"无未读信息\");\n\t\t\t\t} else {\n\t\t\t\t\tconsole.log(\"系统通知信息获取失败\");\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\timport uniPopup from '@/components/uni-popup/uni-popup.vue'\n\t\n    export default {\n\t\tcomponents: {\n\t\t\tuniPopup\n\t\t},\n\t\tdata() {\n\t\t\treturn {\n\t\t\t\tuserName: '',\n\t\t\t\ttoken:'',\n\t\t\t\tcheck_message:'未签到',\n\t\t\t\tstart_at:'',\n\t\t\t\tend_at:'',\n\t\t\t\tisNotCheck:true,\n\t\t\t\tcheck_token:'',\n\t\t\t\tuser_id:0,\n\t\t\t\tisShowPopup:false,\n\t\t\t\tcanICU:false,\n\t\t\t\tcanCheckOff:false,\n\t\t\t\tmessageSrc:'../../static/img/message.png',\n\t\t\t\tmessageIntervalID:-1,\n\t\t\t}\n\t\t},\n        onLoad: function(){\n\t\t\t// 从存储中获取用户登陆信息\n\t\t\tthis.token = uni.getStorageSync('token');\n\t\t\tthis.userName = uni.getStorageSync('userName');\n\t\t\tthis.user_id = uni.getStorageSync('user_id');\n\t\t\tthis.messageSrc = '../../static/img/message.png';\n\t\t\t// 存储控制加班按键的变量\n\t\t\ttry{\n\t\t\t\tuni.setStorageSync('canICU',false);\n\t\t\t}catch(e){\n\t\t\t\tconsole.log('存储出现问题');\n\t\t\t}\n\t\t\t// 检查用户签到状态\n\t\t\tuni.request({\n\t\t\t\turl: webSiteUrl + '/sign/user/' + this.user_id,\n\t\t\t\theader:{\n\t\t\t\t\t'Authorization': 'Bearer '+ this.token,\n\t\t\t\t},\n\t\t\t\tmethod: 'GET',\n\t\t\t\tsuccess:(res) => {\n\t\t\t\t\tconsole.log(res);\n\t\t\t\t\tif(res.statusCode==204){\n\t\t\t\t\t\tthis.check_message = \"未签到\";\n\t\t\t\t\t\tthis.IsNotcheck = true;\n\t\t\t\t\t}\n\t\t\t\t\telse if(res.statusCode==200){\n\t\t\t\t\t\tuni.setStorageSync('sign_id', res.data.sign_id)\n\t\t\t\t\t\tthis.check_message = \"已签到\";\n\t\t\t\t\t\tthis.isNotCheck = false;\n\t\t\t\t\t\tthis.canCheckOff = true;\n\t\t\t\t\t\tthis.start_at = (new Date(res.data.shift.start_at)).toLocaleString('zh-CN', {\n\t\t\t\t\t\t\ttimeZone: 'Asia/Shanghai',\n\t\t\t\t\t\t\thour12: false\n\t\t\t\t\t\t});\n\t\t\t\t\t\tthis.end_at = (new Date(res.data.shift.end_at)).toLocaleString('zh-CN', {\n\t\t\t\t\t\t\ttimeZone: 'Asia/Shanghai',\n\t\t\t\t\t\t\thour12: false\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\tthis.check_message = \"服务器异常\";\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\t// 获取用户基本信息，并存入缓存\n\t\t\tuni.request({\n\t\t\t\turl: webSiteUrl + '/user/' + this.user_id,\n\t\t\t\theader: {\n\t\t\t\t\t'Authorization': 'Bearer '+ this.token,\n\t\t\t\t},\n\t\t\t\tmethod:'GET',\n\t\t\t\tsuccess: res=> {\n\t\t\t\t\tif (res.statusCode==200) {\n\t\t\t\t\t\tconsole.log(\"获取用户信息成功\");\n\t\t\t\t\t\t// 存储用户信息到本地\n\t\t\t\t\t\ttry{\n\t\t\t\t\t\t\tuni.setStorageSync('name',res.data.data.name);\n\t\t\t\t\t\t\tuni.setStorageSync('department',res.data.data.department);\n\t\t\t\t\t\t\tuni.setStorageSync('role',res.data.data.role);\n\t\t\t\t\t\t\tuni.setStorageSync('hours',res.data.data.hours);\n\t\t\t\t\t\t}catch(e){\n\t\t\t\t\t\t\tconsole.log(\"存储出现问题\");\n\t\t\t\t\t\t}\n\t\t\t\t\t} else{\n\t\t\t\t\t\tconsole.log(\"获取用户信息失败\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\t// 存储是否控制是否查询的变量\n\t\t\ttry{\n\t\t\t\tuni.setStorageSync('start_query_unread_message',true);\n\t\t\t}catch(e){\n\t\t\t\tconsole.log(\"存储出现问题\");\n\t\t\t}\n\t\t\t// （页面加载时）查询一次用户是否有unread消息\n\t\t\tvar that = this;\n\t\t\thasUnreadMessage(that);\n\t\t\t/** \n\t\t\t* 开启计时器，每隔 60s，利用localstorage中的变量start_query_unread_message判断是否进行查询。\n\t\t\t*\t停止查询的条件:\n\t\t\t*\t\t上一次查询查到有unread信息\n\t\t\t*\t重新开始查询的条件：\n\t\t\t* \t\t在message页面将unread全部“查看”\n\t\t\t* 停止计时器：页面unload时\n\t\t\t* \n\t\t\t*/\n\t\t\tconsole.log('开启计时器');\n\t\t\tthis.messageIntervalID = setInterval(function(that){\n\t\t\t\tif (uni.getStorageSync('start_query_unread_message')) {\n\t\t\t\t\thasUnreadMessage(that);\n\t\t\t\t} else {\n\t\t\t\t\tconsole.log(\"上次的新信息还没处理完\");\n\t\t\t\t}\n\t\t\t},60000,that);\n        },\n\t\t// 当退出小程序的时候，关闭计时器\n\t\tonUnload:function(){\n\t\t\tif(this.messageIntervalID != -1) {\n\t\t\t\tclearInterval(this.messageIntervalID);\n\t\t\t\tthis.messageIntervalID = -1;\n\t\t\t\tconsole.log('关闭计时器');\n\t\t\t}\n\t\t},\n\t\tonShow:function(){\n\t\t\ttry{\n\t\t\t\tthis.canICU = uni.getStorageSync('canICU');\n\t\t\t}catch(e){\n\t\t\t\tconsole.log('存储出现问题');\n\t\t\t}\n\t\t},\n\t\tmethods:{\n\t\t\tgoShiftArrangement(e) {\n\t\t\t\tconsole.log(e)\n\t\t\t\tuni.navigateTo({\n\t\t\t\t\turl: '../shiftarrangement/shiftarrangement'\n\t\t\t\t});\n\t\t\t},\n\t\t\tgoLeave(e){\n\t\t\t\tconsole.log(e)\n\t\t\t\tuni.navigateTo({\n\t\t\t\t\turl: '../leave/apply/apply'\n\t\t\t\t});\n\t\t\t},\n\t\t\tgoICU(e){\n\t\t\t\tconsole.log(e)\n\t\t\t\tuni.navigateTo({\n\t\t\t\t\turl: '../icu/icu'\n\t\t\t\t});\n\t\t\t},\n\t\t\tgoInfo(e){\n\t\t\t\tconsole.log(e)\n\t\t\t\tuni.navigateTo({\n\t\t\t\t\turl: '../info/info'\n\t\t\t\t});\n\t\t\t},\n\t\t\tcheckIn(e){\n\t\t\t\t// 先扫描获得签到token(只允许通过相机扫码)\n\t\t\t\tuni.scanCode({\n\t\t\t\t\tonlyFromCamera: true,\n\t\t\t\t\tsuccess: (res) => {\n\t\t\t\t\t\tconsole.log('条码内容：' + res.result);\n\t\t\t\t\t\tthis.check_token = res.result;\n\t\t\t\t\t\t// 通过二维码获得的token，向服务器签到\n\t\t\t\t\t\tuni.request({\n\t\t\t\t\t\t\turl: webSiteUrl + '/sign/qrcode/' + this.user_id,\n\t\t\t\t\t\t\tmethod:'POST',\n\t\t\t\t\t\t\theader:{\n\t\t\t\t\t\t\t\t'Authorization': 'Bearer '+ this.token,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tdata:{\n\t\t\t\t\t\t\t\ttoken: this.check_token\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tsuccess: res => {\n\t\t\t\t\t\t\t\tconsole.log(res);\n\t\t\t\t\t\t\t\ttry{\n\t\t\t\t\t\t\t\t\tif (res.statusCode==200) {\n\t\t\t\t\t\t\t\t\t\tconsole.log(\"签到成功\");\n\t\t\t\t\t\t\t\t\t\t// 存储sign_id到本地\n\t\t\t\t\t\t\t\t\t\ttry{\n\t\t\t\t\t\t\t\t\t\t\tuni.setStorageSync('sign_id',res.data.sign_id);\n\t\t\t\t\t\t\t\t\t\t}catch(e){\n\t\t\t\t\t\t\t\t\t\t\tconsole.log(\"sign_id存储出现问题\");\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\t\t\t\t\tduration:2000,\n\t\t\t\t\t\t\t\t\t\t\ttitle:'签到成功'\n\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t\tthis.start_at = res.data.shift.start_at;\n\t\t\t\t\t\t\t\t\t\tthis.end_at = res.data.shift.end_at;\n\t\t\t\t\t\t\t\t\t} else{\n\t\t\t\t\t\t\t\t\t\tconsole.log(\"签到失败\");\n\t\t\t\t\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\t\t\t\t\tduration:2000,\n\t\t\t\t\t\t\t\t\t\t\ttitle:'签到失败'\n\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}catch(e){\n\t\t\t\t\t\t\t\t\tconsole.log(\"签到失败:\",e);\n\t\t\t\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\t\t\t\tduration:2000,\n\t\t\t\t\t\t\t\t\t\ttitle:'签到失败'\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tfail() {\n\t\t\t\t\t\t\t\tconsole.log(\"接口调用失败\");\n\t\t\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\t\t\tduration:2000,\n\t\t\t\t\t\t\t\t\ttitle:'签到失败'\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t},\n\t\t\t\t\tfail() {\n\t\t\t\t\t\tconsole.log(\"扫码失败\");\n\t\t\t\t\t},\n\t\t\t\t\tcomplete() {\n\t\t\t\t\t\t// 刷新home页面\n\t\t\t\t\t\tuni.redirectTo({\n\t\t\t\t\t\t\turl: '../home/home'\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\t\t\tgoMessage(e){\n\t\t\t\tconsole.log(e)\n\t\t\t\tuni.navigateTo({\n\t\t\t\t\turl: '../message/message'\n\t\t\t\t});\n\t\t\t},\n\t\t\t// 签退\n\t\t\tcheckOff(e){\n\t\t\t\tuni.request({\n\t\t\t\t\turl: webSiteUrl + '/sign/off/' + uni.getStorageSync('sign_id'),\n\t\t\t\t\tmethod: 'POST',\n\t\t\t\t\theader:{\n\t\t\t\t\t\t'Authorization': 'Bearer ' + this.token\n\t\t\t\t\t},\n\t\t\t\t\tsuccess: (res) => {\n\t\t\t\t\t\tif(res.statusCode==200){\n\t\t\t\t\t\t\tthis.canICU = res.data.overtime;\n\t\t\t\t\t\t\tthis.isNotCheck = true;\n\t\t\t\t\t\t\tthis.canCheckOff = false;\n\t\t\t\t\t\t\tthis.check_message = \"未签到\";\n\t\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\t\tduration:2000,\n\t\t\t\t\t\t\t\ttitle:'签退成功'\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\ttry{\n\t\t\t\t\t\t\t\tuni.setStorageSync('canICU',true);\n\t\t\t\t\t\t\t}catch(e){\n\t\t\t\t\t\t\t\tconsole.log('存储出现问题');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse{\n\t\t\t\t\t\t\tconsole.log(\"签退失败\");\n\t\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\t\tduration:2000,\n\t\t\t\t\t\t\t\ttitle:'签退失败'\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tfail() {\n\t\t\t\t\t\tconsole.log(\"签退失败\");\n\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\tduration:2000,\n\t\t\t\t\t\t\ttitle:'签退失败'\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n    }\n","// extracted by mini-css-extract-plugin","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","import { render, staticRenderFns } from \"./home.vue?vue&type=template&id=7cd114b4&\"\nimport script from \"./home.vue?vue&type=script&lang=js&\"\nexport * from \"./home.vue?vue&type=script&lang=js&\"\nimport style0 from \"./home.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-loader\\\\lib\\\\runtime\\\\componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-hot-reload-api\\\\dist\\\\index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!module.hot.data) {\n      api.createRecord('7cd114b4', component.options)\n    } else {\n      api.reload('7cd114b4', component.options)\n    }\n    module.hot.accept(\"./home.vue?vue&type=template&id=7cd114b4&\", function () {\n      api.rerender('7cd114b4', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"D:/HBuilderX/attsys-miniprogram/pages/home/home.vue\"\nexport default component.exports","import mod from \"-!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!./home.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!./home.vue?vue&type=script&lang=js&\"","import mod from \"-!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--6-oneOf-1-0!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--6-oneOf-1-1!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\index.js??ref--6-oneOf-1-2!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--6-oneOf-1-3!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!./home.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--6-oneOf-1-0!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--6-oneOf-1-1!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\index.js??ref--6-oneOf-1-2!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--6-oneOf-1-3!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!./home.vue?vue&type=style&index=0&lang=css&\"","export * from \"-!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-loader\\\\lib\\\\loaders\\\\templateLoader.js??vue-loader-options!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--17-0!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\template.js!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!./home.vue?vue&type=template&id=7cd114b4&\""],"sourceRoot":""}